<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Auralis - IA Locale</title>
<style>
:root { --bg: #041014; --neon: #29f7c5; --text: #e6fff9; }
html,body{ height:100%; margin:0; background:var(--bg); color:var(--text); font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
canvas#bg{ position:fixed; inset:0; width:100%; height:100%; z-index:0; display:block; }
.wrap{ position:relative; z-index:2; height:100vh; display:flex; align-items:center; justify-content:center; padding:24px; box-sizing:border-box; }
.wrap .card{ width:480px; max-width:calc(100% - 32px); height:700px; max-height:calc(100vh - 48px); display:flex; flex-direction:column; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06)); border:1px solid rgba(41,247,197,0.06); box-shadow: 0 12px 60px rgba(0,0,0,0.6); overflow:hidden; }
.header{ padding:14px 16px; display:flex; align-items:center; gap:12px; border-bottom:1px solid rgba(255,255,255,0.02); }
.logo{ width:44px; height:44px; border-radius:8px; background:linear-gradient(135deg, rgba(41,247,197,0.12), rgba(20,211,180,0.04)); display:flex; align-items:center; justify-content:center; color:var(--neon); font-weight:700; }
.title{ font-size:15px; font-weight:600; color:var(--text); }
.subtitle{ font-size:12px; color:#9fded0; opacity:0.85; }
.msgs{ flex:1; padding:16px; overflow:auto; display:flex; flex-direction:column; gap:12px; }
.msg{ max-width:78%; padding:10px 12px; border-radius:10px; font-size:14px; line-height:1.4; box-shadow: 0 6px 18px rgba(0,0,0,0.45); }
.msg.user{ align-self:flex-end; background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.05)); color:#fff; border:1px solid rgba(255,255,255,0.06); }
.msg.bot{ align-self:flex-start; background:linear-gradient(180deg, rgba(20,211,180,0.12), rgba(20,211,180,0.05)); color:#b8fff0; border:1px solid rgba(20,211,180,0.18); text-shadow:0 0 6px rgba(41,247,197,0.4); }
.controls{ padding:12px; display:flex; gap:8px; border-top:1px solid rgba(255,255,255,0.02); align-items:center; }
input[type="text"]{ flex:1; padding:12px; border-radius:8px; border:1px solid rgba(255,255,255,0.03); background:rgba(255,255,255,0.02); color:var(--text); outline:none; font-size:14px; }
button.send{ padding:10px 12px; border-radius:8px; border:none; background:linear-gradient(180deg,var(--neon), #14d3b4); color:#002a24; font-weight:700; cursor:pointer; }
.small{ font-size:12px; color:#98efdf; padding:8px 12px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.03)); }
.typing{ width:56px; height:28px; display:flex; gap:6px; align-items:center; justify-content:center; }
.dot{ width:8px; height:8px; border-radius:50%; background:#29f7c5; opacity:0; transform:translateY(0); animation:pop 1s infinite; }
.dot:nth-child(2){ animation-delay:0.15s; } .dot:nth-child(3){ animation-delay:0.30s; }
@keyframes pop{ 0%{ opacity:0; transform:translateY(0) scale(.6); } 40%{ opacity:1; transform:translateY(-6px) scale(1.1); } 100%{ opacity:0; transform:translateY(0) scale(.85); } }
</style>
</head>
<body>
<canvas id="bg" aria-hidden="true"></canvas>
<div class="wrap">
  <div class="card" role="application" aria-label="Auralis assistant">
    <div class="header">
      <div class="logo">AU</div>
      <div>
        <div class="title">Auralis</div>
        <div class="subtitle">Assistant IA local</div>
      </div>
    </div>

    <div id="messages" class="msgs" aria-live="polite"></div>

    <div class="controls">
      <input id="input" type="text" placeholder="Pose une question (ex: idee de site)" />
      <button id="send" class="send">Envoyer</button>
    </div>
    <div class="small">Astuce: enseigne:question=>réponse pour apprendre.</div>
  </div>
</div>

<script>
/* Fond animé non interactif léger */
(function(){
  const canvas = document.getElementById('bg'), ctx = canvas.getContext('2d');
  const CFG = { n:110, speed:0.22, link:140, point:'#29f7c5', bg:'#041014', glow:0.08 };
  let DPR = Math.max(1, devicePixelRatio || 1), w=0, h=0, pts=[];
  function resize(){ w=innerWidth; h=innerHeight; canvas.width=w*DPR; canvas.height=h*DPR; ctx.setTransform(DPR,0,0,DPR,0,0); init(); }
  function rand(a,b){ return Math.random()*(b-a)+a; }
  function init(){ pts=[]; for(let i=0;i<CFG.n;i++){ pts.push({ x:rand(0,w), y:rand(0,h), vx:rand(-CFG.speed,CFG.speed), vy:rand(-CFG.speed,CFG.speed), r:rand(1,3) }); } }
  function drawBg(){ ctx.fillStyle=CFG.bg; ctx.fillRect(0,0,w,h); }
  function draw(){
    ctx.save(); ctx.globalCompositeOperation='lighter';
    for(let i=0;i<pts.length;i++){
      const a = pts[i];
      for(let j=i+1;j<pts.length;j++){
        const b = pts[j]; const dx=a.x-b.x, dy=a.y-b.y; const d=Math.hypot(dx,dy);
        if(d<CFG.link){ ctx.strokeStyle = `rgba(41,247,197,${(1-d/CFG.link)*0.36})`; ctx.beginPath(); ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y); ctx.stroke(); }
      }
    }
    ctx.restore();
    for(const p of pts){
      const g = ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*6);
      g.addColorStop(0, `rgba(41,247,197,${CFG.glow*4})`); g.addColorStop(1,'rgba(0,0,0,0)');
      ctx.fillStyle = g; ctx.beginPath(); ctx.arc(p.x,p.y,p.r*6,0,Math.PI*2); ctx.fill();
      ctx.fillStyle = CFG.point; ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
    }
  }
  function update(){ for(const p of pts){ p.x += p.vx; p.y += p.vy; if(p.x<0||p.x>w) p.vx*=-1; if(p.y<0||p.y>h) p.vy*=-1; } }
  function frame(){ drawBg(); update(); draw(); requestAnimationFrame(frame); }
  window.addEventListener('resize', resize); resize(); frame();
})();

/* Chat minimal (envoie au server /api/chat) */
(function(){
  const msgs = document.getElementById('messages'), input = document.getElementById('input'), send = document.getElementById('send');
  function add(text, who='bot'){ const d = document.createElement('div'); d.className = 'msg ' + (who==='user'?'user':'bot'); d.innerText = text; msgs.appendChild(d); msgs.scrollTop = msgs.scrollHeight; }
  async function sendMsg(){
    const t = input.value.trim(); if(!t) return; add(t,'user'); input.value='';
    try{
      const r = await fetch('/api/chat',{ method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ message: t }) });
      const j = await r.json();
      add(j.reply || 'Pas de réponse','bot');
    }catch(e){
      add('Erreur serveur ou connexion.','bot');
      console.error(e);
    }
  }
  send.addEventListener('click', sendMsg); input.addEventListener('keydown', e=>{ if(e.key==='Enter') sendMsg(); });
  add('🌌 Bonjour, je suis Auralis — ton assistant local. Essaie : enseigne:bonjour=>Salut !','bot');
})();
</script>
</body>
</html>
